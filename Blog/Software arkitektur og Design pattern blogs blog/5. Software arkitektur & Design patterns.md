

#  Observer Pattern vs. Domain Events 

## MÃ¥l for etapen_

At afprÃ¸ve nogle af de patterns jeg havde lÃ¦st om â€” isÃ¦r Observer og Domain Events â€” for at finde ud af, hvilke der faktisk gav mening i projektets arkitektur og i vores domÃ¦nelogik.
Her er det oplagt at kigge pÃ¥ begge to samtidigt da de kan opfylde lidt af samme formÃ¥l pÃ¥ forskellige niveauer.


## Hvad jeg lÃ¦rte denne uge_

[[Domain Events VS. Observer Pattern]]

Jeg startede faktisk med Observer Pattern, mest fordi det er et mÃ¸nster man ofte stÃ¸der pÃ¥ tidligt, og det virker meget intuitivt:  
â€œnoget Ã¦ndrer sig Ã©t sted â†’ noget andet reagerer automatisk.â€

Det lÃ¸d som noget, vi kunne fÃ¥ glÃ¦de af i projektet, isÃ¦r fordi vi har omrÃ¥der hvor der sker â€œÃ¦ndringerâ€, fx nÃ¥r der bliver oprettet nyt "content" eller Ã¦ndret i et "membership"

Men da jeg lavede spikeprojektet og prÃ¸vede Observer Pattern af, gik det hurtigt op for mig, at det ikke passede naturligt ind i vores arkitektur**.

### Hvorfor Observer Pattern ikke rigtig gav mening hos os

Det, der isÃ¦r stod klart, var:

- det ligger meget tÃ¦t pÃ¥ UI-tÃ¦nkning (â€œjeg observerer en propertyâ€)
- i Blazor sker der allerede automatiske UI-opdateringer via binding, sÃ¥ vi ville reelt bare lave dobbelt arbejde
- det binder tingene sammen pÃ¥ en mÃ¥de, som ikke matcher Clean Architecture

Observer Pattern ville bare skabe kobling mellem omrÃ¥der, der ikke skal kende hinanden.

Det passer fint i smÃ¥ apps eller rene UI-scenarier og med mindre lagdeling end det vi sigter efter i vores projekt.


### Hvor Domain Events derimod gav mening

Da jeg sÃ¥ prÃ¸vede Domain Event Pattern af var det lidt mere oplagt i min verden i forhold til projektet.

For eksempel:

- NÃ¥r der bliver oprettet et **post**, kan domÃ¦net rejse et `PostCreatedEvent`.  
    Det betyder, at resten af systemet _kan_ reagere â€” men domÃ¦net er ligeglad med hvordan.

- NÃ¥r et **membership** Ã¦ndres til premium, kan domÃ¦net rejse et `MembershipUpgradedEvent`.  
    Det giver os en naturlig hook til at opdatere permissions, sende notifikationer eller trigge noget i AI-modulet.

- NÃ¥r et **review** bliver oprettet, kan der sÃ¦ttes gang i moderation, scoreberegning eller andre processer â€” igen _uden_ at review-logikken ved det.

Det der gÃ¸r Domain Events sÃ¥ stÃ¦rke i _vores_ projekt er:

- domÃ¦net stÃ¥r rent â€” ingen afhÃ¦ngigheder
- Application-laget hÃ¥ndterer eventet â€” hvor reglerne og flowet hÃ¸rer hjemme
- Infrastructure tager sig af side-effekter (emails, logs, AI-kald)
- vi kan bygge cross-module flows **uden at flette modulerne sammen**
- det passer til Clean Architectures krav om afhÃ¦ngighedsretning
- det forbereder os pÃ¥, at systemet kan vokse i moduler over tid
- Minimal coupling

## ğŸ’¡ _Refleksion_

I starten troede jeg, at Observer Pattern og Domain Events var â€œnÃ¦sten det sammeâ€.  
Men efter at have afprÃ¸vet dem i praksis, kunne jeg se forskellen meget tydeligt:

- **Observer Pattern** er et simpelt, generelt mÃ¸nster (UI / lokale komponenter)
- **Domain Events** er et domÃ¦necentreret mÃ¸nster (DDD / Clean Architecture)

Domain Events passer direkte ind i Clean Architectureâ€™s afhÃ¦ngighedsregler,  
hvor domÃ¦net faktisk _er_ i centrum.

Observer Pattern er fint i simple apps, men Domain Events gav mig et strukturelt vÃ¦rktÃ¸j,  
som jeg kunne bygge videre pÃ¥ â€” bÃ¥de i Application-laget og i moduleringen af domÃ¦net.


## ğŸ’¡ _Projekt specifikt_

PÃ¥ det her tidspunkt var jeg begyndt at arbejde med Clean Architecture i mappestrukturen.  
Det betÃ¸d primÃ¦rt, at jeg fik opdelt projektet i de fire klare lag:

- **Domain**
- **Application**
- **Infrastructure**
- **Web**

Det var ogsÃ¥ i den her fase, at Domain Events begyndte at give rigtig meget mening â€” isÃ¦r i **content** og **membership**.

For eksempel:

- NÃ¥r et nyt content-post blev oprettet, kunne jeg se et klart behov for at generere en hÃ¦ndelse, som senere kunne bruges til ting som notifikationer eller AI-analyse.

- NÃ¥r et membership blev opgraderet fra standard â†’ premium, var det oplagt at markere det som en event, fordi det Ã¥bner for flere automatiske handlinger (fx opdatering af permissions, triggers til andre moduler osv.).


Selvom jeg ikke havde implementeret alle detaljer endnu, kunne jeg allerede se, at Domain Events ville blive en naturlig del af projektet.  
Det passede til mÃ¥den domÃ¦net var ved at vokse pÃ¥ â€” og Clean Architecture gjorde det lettere at holde hÃ¦ndelserne renere og mere fokuserede.

Det fÃ¸ltes som det fÃ¸rste rigtige skridt mod en lÃ¸sning, der kunne skaleres og udvides, uden at systemet blev rodet.